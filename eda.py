import pandas as pd
import matplotlib.pyplot as plt

# Raw time series data
data = [
    (28072365, 1541.32896169), (28072596, 1559.22379594), (28108764, 1560.42016293),
    (28108815, 1558.55464416), (28108886, 1558.28541441), (28109015, 1559.84031298),
    (28109904, 1559.82165163), (28109980, 1559.18736468), (28110127, 1559.84171294),
    (28110584, 1557.45026440), (28112631, 1558.52204324), (28112698, 1558.50821847),
    (28142887, 1554.04760817), (28152272, 1550.07733594), (28202635, 1545.40714617),
    (28369421, 1543.79652119), (28378633, 1542.18910883), (28394512, 1541.85577109),
    (28409654, 1541.80321720), (28410021, 1541.79908340), (28445404, 1541.80214174),
    (28497905, 1541.80206070), (28532206, 1541.50958043), (28615052, 1539.36941218),
    (28615180, 1546.85395872), (28618069, 1555.21851499), (28618396, 1578.13280504),
    (28627481, 1589.82787117), (28657835, 1618.12385637), (28657923, 1627.61131628),
    (28658508, 1635.61678628), (28675869, 1630.76264905), (28681898, 1625.85758660),
    (28818996, 1620.77351176), (28908352, 1620.70930685), (28919359, 1620.64465318),
    (28919370, 1620.58000339), (28964850, 1620.25752976), (29008008, 1615.33438645),
    (29027810, 1610.41814953), (29050992, 1604.35147249), (29051060, 1598.31901206),
    (29228585, 1598.28858074), (29268354, 1612.58233453), (29268859, 1600.60224662),
    (29269626, 1612.57632813), (29269729, 1599.81862272), (29271864, 1612.56993888),
    (29272368, 1599.81408459), (29272837, 1612.48015802), (29281713, 1606.08555614),
    (29305396, 1618.81885711), (29305600, 1622.01003808), (29305961, 1602.76580370),
    (29306047, 1605.94113036), (29306215, 1622.00038724), (29307007, 1621.93565630),
    (29307048, 1622.00040584), (29307239, 1621.93542170), (29307783, 1622.00037335),
    (29322356, 1602.75631045), (29329922, 1602.74359368), (29348591, 1610.68775223),
    (29356044, 1626.63497721), (29356315, 1620.15336062), (29356582, 1621.74921554),
    (29356715, 1602.50859183), (29363238, 1602.50859115), (29391132, 1612.10689316),
    (29425530, 1607.80700029), (29522548, 1607.74311713), (29525160, 1607.73034096),
    (29610950, 1601.36127776), (29615316, 1609.30200893), (29615388, 1602.92641156),
    (29615606, 1610.87101753), (29622158, 1606.14134025), (29629536, 1605.84476219),
    (29630144, 1599.48967842), (29631904, 1605.84174861), (29636811, 1605.35474905),
    (29648354, 1593.31529514), (29650789, 1592.36946273), (29653485, 1598.70263828),
    (29661017, 1598.04857582), (29661417, 1585.57890996), (29697606, 1585.34947349),
    (29709786, 1585.22525401), (29709851, 1583.98386185), (29709863, 1583.36371252),
    (29724703, 1583.35123833), (29746718, 1583.33881424), (29749104, 1580.24359672),
    (29785544, 1580.22080646), (29811945, 1580.20835695), (29812443, 1580.19590757),
    (29835902, 1586.50485240), (29835973, 1592.82636640), (29836249, 1594.42999958),
    (29836551, 1590.48591451), (29967467, 1587.86770058), (29987338, 1587.85513031),
    (30092739, 1599.69681430), (30092958, 1611.58249002), (30093194, 1603.28673794),
    (30129793, 1603.28673724), (30129838, 1606.50309190), (30173570, 1611.69994848),
    (30173772, 1635.65774149), (30175713, 1630.41388627), (30196144, 1621.12976541)
]

# Create DataFrame
df = pd.DataFrame(data, columns=['block', 'price'])

# Print first few rows
print("First 10 observations:")
print(df.head(10))

# Basic descriptive statistics
print("\nDescriptive Statistics for Price:")
print(df['price'].describe())

# Plot 1: Price vs. Block
plt.figure()
plt.plot(df['block'], df['price'])
plt.title('Price over Block Numbers')
plt.xlabel('Block Number')
plt.ylabel('Price')
plt.show()

# Plot 2: Histogram of Prices
plt.figure()
plt.hist(df['price'], bins=20)
plt.title('Histogram of Prices')
plt.xlabel('Price')
plt.ylabel('Frequency')
plt.show()

# Plot 3: Rolling Mean (window=5)
df['rolling_mean'] = df['price'].rolling(window=5).mean()
plt.figure()
plt.plot(df['block'], df['rolling_mean'])
plt.title('5-Block Rolling Mean of Price')
plt.xlabel('Block Number')
plt.ylabel('Rolling Mean Price')
plt.show()
